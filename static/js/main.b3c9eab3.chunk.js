(this["webpackJsonpprogressciv-frontend"]=this["webpackJsonpprogressciv-frontend"]||[]).push([[0],{28:function(e){e.exports=JSON.parse('{"items":[{"product":"wheat","quantity":2,"time":1000,"startingActive":1,"upgrades":[{"aspect":"production","operation":"+","amount":1,"demands":{"farm":1}}]},{"product":"wood","quantity":1,"time":1000,"startingActive":1,"upgrades":[{"aspect":"production","operation":"+","amount":1,"demands":{"forest":1}}]},{"product":"worker","quantity":1,"time":3000,"startingActive":1,"demands":{"wheat":10}},{"product":"farm","quantity":1,"time":10000,"startingActive":1,"demands":{"wood":5,"wheat":2},"upgrades":[{"aspect":"production","operation":"+","amount":1,"demands":{"building-site":1}}]},{"product":"forest","quantity":1,"time":10000,"startingActive":1,"demands":{"wood":10}},{"product":"coal","quantity":5,"time":8000,"startingActive":0,"upgrades":[{"aspect":"production","operation":"+","amount":1,"demands":{"mine":1}}]},{"product":"fuel","quantity":1,"time":2000,"startingActive":1,"demands":{"wood":3}},{"product":"fuel","quantity":5,"time":2000,"startingActive":1,"demands":{"coal":1}},{"product":"mine","quantity":1,"time":20000,"startingActive":1,"demands":{"wood":25}},{"product":"furnace","quantity":1,"time":20000,"startingActive":1,"demands":{"stone":5}}]}')},34:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),o=n(25),i=n.n(o),s=(n(33),n(34),n(26)),a=n(17),d=n(15),u=n(16),p=n(2),l=n(3),m=n(0),j={wheat:"\ud83c\udf3d",worker:"\ud83d\udcaa",wood:"\ud83c\udf33",farm:"\ud83c\udf3e\ud83c\udf3e",forest:"\ud83c\udf32\ud83c\udf32\ud83c\udf32","large-red-circle":"\ud83d\udd34","large-green-circle":"\ud83d\udfe2","allow production":"\u2699\ufe0f","allow demand to be met":"\ud83d\udce6",time:"\u231b",quantity:"\u2b06\ufe0f","shopping-cart":"\ud83d\uded2",production:"\u2699\ufe0f","building-site":"\ud83c\udfd7\ufe0f"};function b(e){return Object(m.jsx)("span",{title:e,children:void 0===j[e]?e:j[e]})}n(64);function O(e){var t=e.percent,n=void 0===t?0:t,c=e.always,r=void 0!==c&&c,o=e.children;return Object(m.jsxs)("div",{className:"production-bar",style:{width:"100%"},children:[Object(m.jsx)("span",{className:"label",children:o}),!r&&Object(m.jsx)("div",{className:"production-progress-bar bg-success",style:{width:"".concat(n,"%")}}),r&&Object(m.jsx)("div",{className:"production-progress-bar bg-success meter always",children:Object(m.jsx)("span",{style:{width:"100%"},children:Object(m.jsx)("span",{})})})]})}n(65);var f=function(e,t){return Object(m.jsx)("div",{className:"requirement",children:Object(m.jsxs)(O,{percent:e.quantity/e.capacity*100,children:[e.quantity," / ",e.capacity," ",b(e.resource)]})},t)};function v(e){var t=e.requirements,n=void 0===t?[]:t;e.met;return 0===n.length?Object(m.jsx)("div",{className:"requirements none"}):Object(m.jsx)("div",{className:"requirements",children:n.map(f)})}n(66),n(67);function g(e){var t=e.onClick,n=void 0===t?function(){}:t,c=e.state,r=void 0!==c&&c,o=e.icon;return Object(m.jsx)("div",{className:"button ".concat(r?"open":"closed"),onClick:n,children:o})}n(68);var h=function(e,t){return Object(m.jsxs)("div",{className:"upgrade",children:[Object(m.jsxs)("div",{className:"effect",children:[Object(m.jsx)("div",{className:"aspect",children:b(e.aspect)}),Object(m.jsxs)("div",{className:"improvement",children:[e.operation,e.amount]})]}),Object(m.jsx)("div",{className:"demands",children:Object.keys(e.demands).map((function(t){return function(e,t,n){return Object(m.jsxs)("div",{className:"demand",children:[Object(m.jsx)("div",{className:"resource",children:b(e)}),Object(m.jsxs)("div",{className:"amount",children:["x",t]}),Object(m.jsx)(g,{icon:b("shopping-cart"),state:n.requested,onClick:function(){return n.requestToggle()}})]},e)}(t,e.demands[t],e)}))})]},t)};function x(e){var t=e.upgrades;return Object(m.jsx)("div",{className:"upgrades",children:t.sort((function(e,t){return e.aspect<t.aspect?1:-1})).map(h)})}n(69);var y=function(e,t){return Object(m.jsx)("div",{className:"production",children:Object(m.jsx)(O,{percent:e.percent,always:"0.00"===(e.productionTime/1e3).toFixed(2)})},t)};function w(e){var t=e.productions;return Object(m.jsx)("div",{className:"productions",children:t.map(y)})}var k=n(4),q=function(){function e(){Object(d.a)(this,e)}return Object(u.a)(e,[{key:"update",value:function(t,n){var c=Object(l.getComponent)(n.filter(Object(l.HasComponent)(p.Store))[0],p.Store),r=n.filter(Object(l.HasComponent)(p.Demand)).filter(Object(l.HasComponent)(p.ProductionList)).filter(Object(l.HasComponent)(p.Supply)).map((function(e){return{id:e.id,demand:Object(l.getComponent)(e,p.Demand),productionList:Object(l.getComponent)(e,p.ProductionList),supply:Object(l.getComponent)(e,p.Supply),upgrades:Object(l.hasComponent)(e,p.Upgrade)?Object(l.getComponent)(e,p.Upgrade).upgrades.reduce((function(e,t){return e.push(t),e}),[]):[]}})).map((function(e){var t;return{id:e.id,product:e.supply.product.resource,quantity:e.supply.product.quantity,storage:c.stocks[e.supply.product.resource],capacity:c.capacities[e.supply.product.resource],met:e.demand.met,productions:e.productionList.productions.map((function(e){return{percent:Math.min(e.progress/e.productionTime*100,100),productionTime:e.productionTime}})),open:e.demand.open,working:e.demand.working,canWork:e.productionList.maximumActive>0,handleOpen:function(){e.demand.open=!e.demand.open},handleWorking:function(){e.demand.working=!e.demand.working},requirements:Object.keys(e.demand.demands).map((function(t){var n;return{resource:t,quantity:null!==(n=e.demand.store.stocks[t])&&void 0!==n?n:0,capacity:e.demand.store.capacities[t]}})),upgrades:null===(t=e.upgrades)||void 0===t?void 0:t.map((function(e){return{amount:e.amount,aspect:e.aspect,operation:e.operation,demands:e.demands,requested:e.requested,requestToggle:function(){e.requested=!e.requested}}}))}}));e.setItems(r)}}]),e}();q.setItems=function(){};var N=function(e,t){return Object(m.jsxs)("div",{className:"item",children:[0===t&&Object(m.jsxs)("h1",{className:"label",children:[b(e.product)," ",Object(m.jsx)("span",{hidden:!1===(n=e.product,void 0!==j[n]),children:e.product})]}),Object(m.jsxs)("div",{className:"item-details",children:[Object(m.jsxs)("div",{className:"storehouse",children:[Object(m.jsx)("div",{className:"open-button",children:e.canWork&&e.requirements.length>0&&Object(m.jsx)(g,{icon:b("allow demand to be met"),state:e.open,onClick:function(){return e.handleOpen()}})}),Object(m.jsx)(v,{requirements:e.requirements,met:e.met})]}),Object(m.jsxs)("div",{className:"workhouse",children:[Object(m.jsx)("div",{className:"working-button",children:e.canWork&&Object(m.jsx)(g,{icon:b("allow production"),state:e.working,onClick:function(){return e.handleWorking()}})}),Object(m.jsx)(w,{productions:e.productions})]}),Object(m.jsx)(x,{upgrades:e.upgrades})]})]},t);var n};function C(){var e=Object(k.f)().id,t=Object(c.useState)([]),n=Object(a.a)(t,2),r=n[0],o=n[1];return q.setItems=o,Object(m.jsx)("div",{id:"items",children:r.filter((function(t){return t.product===e})).map(N)})}var A=n(28),S=(n(75),n(22)),L=n(8),T=n(11),W=(n(76),function(e,t){var n=t.productionList.maximumActive>0,c=e.existed[t.supply.product.resource],r=0===Object.keys(t.demand.demands).length,o=Object.keys(t.demand.demands).reduce((function(t,n){return t&&e.existed[n]}),!0),i=t.upgrades.upgrades.filter((function(e){return"production"===e.aspect})).length>0,s=t.upgrades.upgrades.filter((function(e){return"production"===e.aspect})).reduce((function(e,t){return[].concat(Object(S.a)(e),Object(S.a)(Object.keys(t.demands)))}),[]).reduce((function(t,n){return t&&e.existed[n]}),!0);return!!c||(!(!n||!r)||(!(!n||!o)||!(!i||!s)))}),I=function(){function e(){Object(d.a)(this,e)}return Object(u.a)(e,[{key:"update",value:function(t,n){var c=Object(L.getComponent)(n.filter(Object(L.HasComponent)(p.Store))[0],p.Store),r=n.filter(Object(L.HasComponent)(p.Demand)).filter(Object(L.HasComponent)(p.ProductionList)).filter(Object(L.HasComponent)(p.Supply)).map((function(e){return{demand:Object(L.getComponent)(e,p.Demand),productionList:Object(L.getComponent)(e,p.ProductionList),supply:Object(L.getComponent)(e,p.Supply),upgrades:Object(L.hasComponent)(e,p.Upgrade)?Object(L.getComponent)(e,p.Upgrade):new p.Upgrade({upgrades:[]})}})).map((function(e){var t;return{display:W(c,e),product:e.supply.product.resource,amount:null!==(t=c.stocks[e.supply.product.resource])&&void 0!==t?t:0,capacity:c.capacities[e.supply.product.resource],open:e.demand.open,working:e.demand.working,canWork:e.productionList.maximumActive>0,hasRequirements:Object.keys(e.demand.demands).length>0,handleOpen:function(){e.demand.open=!e.demand.open},handleWorking:function(){e.demand.working=!e.demand.working}}}));e.setStorage(r)}}]),e}();I.setStorage=function(){};var U=function(e,t){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{className:"open-button",children:e.isUnique&&e.value.hasRequirements&&e.value.canWork&&Object(m.jsx)(g,{icon:b("allow demand to be met"),state:e.value.open,onClick:function(){return e.value.handleOpen()}})}),Object(m.jsx)("td",{className:"working-button",children:e.isUnique&&e.value.canWork&&Object(m.jsx)(g,{icon:b("allow production"),state:e.value.working,onClick:function(){return e.value.handleWorking()}})}),Object(m.jsx)("td",{className:"product",children:Object(m.jsx)(T.b,{to:"/".concat(e.value.product),children:b(e.value.product)})}),Object(m.jsxs)("td",{className:"stockpile",children:[e.value.amount," / ",e.value.capacity]})]},t)};function H(){var e=Object(c.useState)([]),t=Object(a.a)(e,2),n=t[0],r=t[1];I.setStorage=r;var o=n.filter((function(e){return e.display})).map((function(e){var t=e;return{value:e,isUnique:1===n.filter((function(e){return e.product===t.product})).length}})),i=o.filter((function(e,t){return t===o.findIndex((function(t){return t.value.product===e.value.product}))}));return Object(m.jsx)("table",{className:"storage",children:Object(m.jsx)("tbody",{children:i.map(U)})})}n(77);function P(){return Object(m.jsxs)("div",{className:"home",children:[Object(m.jsx)(H,{}),Object(m.jsx)(k.c,{children:Object(m.jsx)(k.a,{path:"/:id",children:Object(m.jsx)(C,{})})})]})}var D=n.p+"static/media/logo.0c78ae67.png",F=!1,J=function e(t){return function(){F?F=!1:(t.Update(),window.setTimeout(e(t),25))}};var M=function(){var e=Object(c.useRef)();return Object(c.useMemo)((function(){var t=new s.ProgressCivAPI(A),n=new q,c=new I;t.Instance.systems.push(n),t.Instance.systems.push(c),e.current=function(){return t.Save()},F=!0,window.setTimeout(J(t),100)}),[]),Object(m.jsxs)("div",{children:[Object(m.jsx)("div",{className:"App-header",children:Object(m.jsx)("div",{className:"App-logo",children:Object(m.jsx)("img",{src:D,alt:"progress civ"})})}),Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(T.a,{children:Object(m.jsx)(P,{})})})]})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,80)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),o(e),i(e)}))};i.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(M,{})}),document.getElementById("root")),R()}},[[79,1,2]]]);
//# sourceMappingURL=main.b3c9eab3.chunk.js.map